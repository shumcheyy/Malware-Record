### Introduction
Researchers from Sophos detected ransomware, Epsilon Red, in an investigation on US based Hospitality sector company.Andrew Brandt wrote the report: https://news.sophos.com/en-us/2021/05/28/epsilonred/

The ransomware is named after am enemy character in X-Men, super soldier of russian origin with 4 mechanical tentacles, which seems to represent the way the ransomware is spreads in a corporate network.It is written in Golang. Deployed on the back of a set of PS scripts(12 Scripts) developed for making encryption, exploiting flaws in unpatched MS Exchange Servers

> Based on the cryptocurrency address provided by the attackers, it appears that at least one of their victims paid a ransom of 4.29BTC on May 15th (valued at roughly $210,000 on that date). 

### Working

We saw that there are 12 PowerShell scripts numbered sequentially [{1..12}.ps1], RED.exe, P.exe, C.ps1. S.ps1

![](https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-files-in-folder.png)

During the attack, the threat actors launched this series of PS scripts that prepared the attacked machines for the final ransomware payload and ultimately delivered and initiated it.The PowerShell orchestration was, itself, created and triggered by a PowerShell script named **RED.ps1** that was executed on the target machines using WMI.This script retrives and unpacks into system32 folder a .7z file that contains all these abobe scripts and the executable.

Also schedule tasks that run scripts through 1 to 12 but skips 7 and 8

A typical schedule using PS looked like:
> C:\Windows\system32\schtasks.exe /create /tn Microsoft\Windows\TASK12 /tr "powershell -file c:\windows\system32\RED\12.ps1" /sc minute /mo 2 /ru SYSTEM /f 

The red.ps1 script unpacks RED.7z into the %SYSTEM%\RED directory, then creates scheduled tasks that run the unpacked scripts. But then it waits one hour, and executes commands that modify the Windows Firewall rules such that the firewall blocks inbound connections on all TCP ports except the Remote Desktop Protocolâ€™s 3389/tcp and the communications port used by a commercial tool called ![Remote Utilities](https://www.remoteutilities.com/), 5650/tcp. 

![Shell includes commands that remove tracks](https://news.sophos.com/wp-content/uploads/2021/05/epsilonred-firewall-commands-logo.png?resize=768,260)
























### REFERENCES
* [Article by Andrew Brandt](https://news.sophos.com/en-us/2021/05/28/epsilonred/)
* [Youtube Video of IT AND DEVOPS MASTERCLASS](https://www.youtube.com/watch?v=pW25qpIDTIc)
